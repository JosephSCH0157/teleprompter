{
  "version": 3,
  "sources": ["obs.ts"],
  "sourcesContent": ["// OBS adapter for browser with dev-only candidate auth attempts and identify payload logging\r\n\r\ndeclare global {\r\n  interface Window {\r\n    __obsLog?: Array<{ t: number; ev: string; data?: any }>;\r\n    __obsLogMax?: number;\r\n    logObs?: (ev: string, data?: any) => void;\r\n    __obsHandshakeLog?: any[];\r\n    __obsProbePorts?: (urls: string[]) => Promise<any>;\r\n    __TP_DEV?: boolean;\r\n  }\r\n}\r\n\r\n/** @returns {import('../recorders.js').RecorderAdapter} */\r\nexport function createOBSAdapter() {\r\n  var ws: WebSocket | null = null;\r\n  var identified = false;\r\n  var _lastErr: unknown = null;\r\n  var cfg: {\r\n    url: string;\r\n    password?: string;\r\n    getPass?: () => string;\r\n    onStatus?: (status: string, connected: boolean, meta?: any) => void;\r\n    isEnabled?: () => boolean;\r\n  } = { url: 'ws://127.0.0.1:4455', password: '' };\r\n\r\n  // Dev tracing state\r\n  var _candidateList = null;\r\n  var _candidateIndex = 0;\r\n  var _lastAuthSent: string | null = null;\r\n  var _lastCandidateIndexUsed = null;\r\n  var _retryingCandidates = false;\r\n  // reconnect/backoff state\r\n  var _backoff = 800;\r\n  var _attempts = 0;\r\n\r\n  // lightweight dev log (keeps short history when window._TP_DEV is enabled)\r\n  try {\r\n    if (typeof window !== 'undefined') {\r\n      window.__obsLog = window.__obsLog || [];\r\n      window.__obsLogMax = window.__obsLogMax || 500;\r\n      window.logObs = function (ev, data) {\r\n        try {\r\n          if (!window.__TP_DEV) return;\r\n          window.__obsLog!.push({ t: Date.now(), ev: ev, data: data });\r\n          if (window.__obsLog!.length > (window.__obsLogMax || 0)) {\r\n            window.__obsLog!.splice(0, window.__obsLog!.length - (window.__obsLogMax || 0));\r\n          }\r\n        } catch {\r\n          // ignore\r\n        }\r\n      };\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  var _enc = function (s: string) {\r\n    return new TextEncoder().encode(s);\r\n  };\r\n  var _b64 = function (buf: ArrayBuffer) {\r\n    return btoa(String.fromCharCode(...new Uint8Array(buf)));\r\n  };\r\n  // Keep last auth sent for debug logging\r\n  // canonical OBS v5 auth \u2014 exact recipe (no trims, no decoding, UTF-8 byte hashes)\r\n  const _te = new TextEncoder();\r\n  async function _sha(s: string) {\r\n    return crypto.subtle.digest('SHA-256', _te.encode(s));\r\n  }\r\n  async function computeObsAuth(password: string, authInfo: { salt?: string; challenge?: string } | null | undefined) {\r\n    // authInfo is expected to contain { salt, challenge }\r\n    const salt = authInfo && authInfo.salt ? String(authInfo.salt) : '';\r\n    const challenge = authInfo && authInfo.challenge ? String(authInfo.challenge) : '';\r\n    // 1) secretB64 = base64( SHA256( password + salt ) )\r\n    const secretBuf = await _sha(String(password ?? '') + salt);\r\n    const secretB64 = _b64(secretBuf);\r\n    // 2) authentication = base64( SHA256( secretB64 + challenge ) )\r\n    const authBuf = await _sha(secretB64 + challenge);\r\n    return _b64(authBuf);\r\n  }\r\n\r\n  function configure(newCfg?: Partial<typeof cfg>) {\r\n    cfg = Object.assign({}, cfg, newCfg || {});\r\n  }\r\n  function isAvailable(): Promise<boolean> {\r\n    return Promise.resolve(typeof WebSocket !== 'undefined');\r\n  }\r\n\r\n  // computeAuthCandidates removed; using canonical computeObsAuth\r\n\r\n  function _connect(opts?: { testOnly?: boolean }): Promise<boolean> {\r\n    opts = opts || {};\r\n    var testOnly = !!opts.testOnly;\r\n    return new Promise(function (resolve, reject) {\r\n      try {\r\n        try {\r\n          if (ws) ws.close(1000, 'reconnect');\r\n        } catch {\r\n          // ignore\r\n        }\r\n        identified = false;\r\n        _lastErr = null;\r\n        var url = cfg.url || 'ws://127.0.0.1:4455';\r\n        ws = new WebSocket(url);\r\n\r\n        ws.onopen = function () {\r\n          try {\r\n            if (window && window.__TP_DEV) console.debug('[OBS-HS] socket open', url);\r\n          } catch {\r\n            // ignore\r\n          }\r\n          try {\r\n            window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n            window.__obsHandshakeLog.push({ t: Date.now(), event: 'open', url: url });\r\n            try {\r\n              _backoff = 800;\r\n              _attempts = 0;\r\n            } catch {}\r\n            try {\r\n              cfg.onStatus && cfg.onStatus('connected', true);\r\n              try {\r\n                // dev log\r\n                window.logObs && window.logObs('open', { url: url });\r\n              } catch {\r\n                // ignore\r\n              }\r\n            } catch {}\r\n          } catch {\r\n            // ignore\r\n          }\r\n        };\r\n\r\n        ws.onmessage = async function (ev) {\r\n          try {\r\n            var msg = JSON.parse(ev.data);\r\n            try {\r\n              if (window && window.__TP_DEV) console.debug('[OBS-HS] recv op=' + msg.op, msg.d);\r\n            } catch {\r\n              // ignore\r\n            }\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              window.__obsHandshakeLog.push({ t: Date.now(), op: msg.op, data: msg.d });\r\n            } catch {\r\n              // ignore\r\n            }\r\n\r\n            if (msg.op === 0) {\r\n              var authInfo = msg.d && msg.d.authentication;\r\n              try {\r\n                window.logObs && window.logObs('hello', { authentication: authInfo });\r\n              } catch {\r\n                // ignore\r\n              }\r\n              var identify: { op: number; d: { rpcVersion: number; authentication?: string } } = { op: 1, d: { rpcVersion: 1 } };\r\n              if (authInfo) {\r\n                // Read password without trimming or normalization. Prefer configured value, then cfg.getPass(), then DOM fallbacks.\r\n                var pass = '';\r\n                try {\r\n                  if (typeof cfg.password !== 'undefined' && cfg.password !== null)\r\n                    pass = String(cfg.password);\r\n                  else if (typeof cfg.getPass === 'function') pass = String(cfg.getPass());\r\n                } catch {\r\n                  try {\r\n                    pass = String(cfg.password || '');\r\n                  } catch {\r\n                    pass = '';\r\n                  }\r\n                }\r\n                if (!pass) {\r\n                  try {\r\n                    var domPass = '';\r\n                    var setEl = (typeof document !== 'undefined'\r\n                      ? document.getElementById('settingsObsPass')\r\n                      : null) as HTMLInputElement | null;\r\n                    var mainEl = (typeof document !== 'undefined'\r\n                      ? document.getElementById('obsPassword')\r\n                      : null) as HTMLInputElement | null;\r\n                    // Do NOT trim \u2014 spaces are valid characters\r\n                    if (setEl && setEl.value) domPass = setEl.value;\r\n                    else if (mainEl && mainEl.value) domPass = mainEl.value;\r\n                    if (domPass) pass = domPass;\r\n                    if (domPass && window && window.__TP_DEV)\r\n                      console.debug('[OBS adapter] using DOM password fallback (settings/main)');\r\n                  } catch {\r\n                    /* ignore */\r\n                  }\r\n                }\r\n                if (!pass) {\r\n                  try {\r\n                    ws?.close(4009, 'password-empty');\r\n                  } catch {\r\n                    // ignore\r\n                  }\r\n                  _lastErr = new Error('OBS authentication required but no password is set.');\r\n                  return reject(_lastErr);\r\n                }\r\n\r\n                // Compute canonical OBS v5 authentication value and attach to identify payload\r\n                try {\r\n                  const authVal = await computeObsAuth(pass, authInfo);\r\n                  identify.d.authentication = authVal;\r\n                  _lastAuthSent = authVal;\r\n                  if (window && window.__TP_DEV)\r\n                    console.debug('[OBS-HS] sending IDENTIFY (authentication present)');\r\n                  try {\r\n                    if (window && window.__TP_DEV)\r\n                      console.debug('[OBS-HS] IDENTIFY payload:', identify);\r\n                  } catch {\r\n                    // ignore\r\n                  }\r\n                  try {\r\n                    window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n                    var ent: { t: number; event: string; auth: boolean; identifyPayload?: any } = {\r\n                      t: Date.now(),\r\n                      event: 'identify-sent',\r\n                      auth: !!identify.d.authentication,\r\n                    };\r\n                    if (window && window.__TP_DEV) ent.identifyPayload = identify;\r\n                    window.__obsHandshakeLog.push(ent);\r\n                    window.logObs &&\r\n                      window.logObs('identify-sent', { auth: !!identify.d.authentication });\r\n                  } catch {\r\n                    // ignore\r\n                  }\r\n                } catch (exAuth) {\r\n                  // failed to compute auth \u2014 set last error and close\r\n                  _lastErr = exAuth;\r\n                  try {\r\n                    ws?.close(4009, 'auth-compute-failed');\r\n                  } catch {\r\n                    // ignore\r\n                  }\r\n                  return reject(exAuth);\r\n                }\r\n              }\r\n              try {\r\n                ws?.send(JSON.stringify(identify));\r\n              } catch {\r\n                // ignore\r\n              }\r\n            } else if (msg.op === 2) {\r\n              identified = true;\r\n              try {\r\n                if (window && window.__TP_DEV) console.debug('[OBS-HS] IDENTIFIED', msg.d);\r\n              } catch {\r\n                // ignore\r\n              }\r\n              try {\r\n                window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n                window.__obsHandshakeLog.push({ t: Date.now(), event: 'identified', data: msg.d });\r\n                try {\r\n                  window.logObs && window.logObs('identified', { data: msg.d });\r\n                } catch {\r\n                  // ignore\r\n                }\r\n              } catch {\r\n                // ignore\r\n              }\r\n              if (testOnly) {\r\n                try {\r\n                  ws?.close(1000, 'test-ok');\r\n                } catch {\r\n                  // ignore\r\n                }\r\n              }\r\n              return resolve(true);\r\n            }\r\n          } catch (e) {\r\n            _lastErr = e;\r\n            try {\r\n              ws?.close(4000, 'msg-parse-error');\r\n            } catch {\r\n              // ignore\r\n            }\r\n            return reject(e);\r\n          }\r\n        };\r\n\r\n        ws.onerror = function (ev) {\r\n          try {\r\n            if (window && window.__TP_DEV) console.debug('[OBS-HS] socket error', ev);\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              window.__obsHandshakeLog.push({ t: Date.now(), event: 'error', data: ev });\r\n              try {\r\n                window.logObs && window.logObs('error', { data: ev });\r\n              } catch {\r\n                // ignore\r\n              }\r\n            } catch {\r\n              // ignore\r\n            }\r\n          } catch {\r\n            // ignore\r\n          }\r\n        };\r\n\r\n        ws.onclose = function (e) {\r\n          try {\r\n            if (window && window.__TP_DEV)\r\n              console.debug('[OBS-HS] socket close', e && e.code, e && e.reason);\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              var entry: any = {\r\n                t: Date.now(),\r\n                event: 'close',\r\n                code: (e && e.code) || 0,\r\n                reason: (e && e.reason) || '',\r\n              };\r\n              if (e && e.code === 4009 && window && window.__TP_DEV) {\r\n                try {\r\n                  entry.debugAuth = _lastAuthSent || null;\r\n                } catch {\r\n                  // ignore\r\n                }\r\n              }\r\n              window.__obsHandshakeLog.push(entry);\r\n              try {\r\n                window.logObs &&\r\n                  window.logObs('close', {\r\n                    code: (e && e.code) || 0,\r\n                    reason: (e && e.reason) || '',\r\n                  });\r\n              } catch {\r\n                // ignore\r\n              }\r\n              try {\r\n                // increment attempts and advance backoff for retry reporting\r\n                _attempts = (_attempts || 0) + 1;\r\n                _backoff = Math.min(Math.floor((_backoff || 800) * 1.6), 8000);\r\n                cfg.onStatus &&\r\n                  cfg.onStatus('closed', false, {\r\n                    code: (e && e.code) || 0,\r\n                    reason: (e && e.reason) || '',\r\n                    attempt: _attempts,\r\n                    backoffMs: _backoff,\r\n                  });\r\n              } catch {\r\n                // ignore\r\n              }\r\n            } catch {\r\n              // ignore\r\n            }\r\n          } catch {\r\n            // ignore\r\n          }\r\n\r\n          if (!identified) {\r\n            var err = new Error(\r\n              ('close ' + ((e && e.code) || 0) + ' ' + ((e && e.reason) || '')).trim()\r\n            );\r\n            _lastErr = err;\r\n            try {\r\n              if (\r\n                cfg &&\r\n                typeof cfg.isEnabled === 'function' &&\r\n                cfg.isEnabled() &&\r\n                (e && e.code) !== 1000\r\n              ) {\r\n                try {\r\n                  setTimeout(function () {\r\n                    try {\r\n                      connect();\r\n                    } catch {}\r\n                  }, _backoff);\r\n                } catch {}\r\n              }\r\n            } catch {}\r\n            return reject(err);\r\n          }\r\n        };\r\n      } catch (outer) {\r\n        _lastErr = outer;\r\n        return reject(outer);\r\n      }\r\n    });\r\n  }\r\n\r\n  // wrapper to call _connect in non-test mode; returns a promise\r\n  function connect(): Promise<boolean> {\r\n    return _connect({ testOnly: false });\r\n  }\r\n\r\n  async function start() {\r\n    await connect();\r\n  }\r\n  async function stop() {\r\n    identified = false;\r\n    try {\r\n      if (ws) ws.close(1000, 'stop');\r\n    } catch {\r\n      // ignore\r\n    }\r\n    ws = null;\r\n  }\r\n  async function test() {\r\n    return _connect({ testOnly: true });\r\n  }\r\n  // Dev helper: probe multiple ws URLs (host+port) and return which one authenticates.\r\n  // Accepts an array of url strings (e.g. ['ws://host:4455','ws://host:64376']).\r\n  async function probePorts(urls: string[]) {\r\n    if (!Array.isArray(urls)) throw new Error('urls must be an array');\r\n    const orig = cfg.url;\r\n    const results = [];\r\n    for (let u of urls) {\r\n      try {\r\n        cfg.url = u;\r\n        try {\r\n          const ok = await _connect({ testOnly: true });\r\n          results.push({ url: u, ok: !!ok });\r\n          if (ok) {\r\n            // restore and return early with success\r\n            cfg.url = orig;\r\n            return { success: true, url: u, results };\r\n          }\r\n        } catch (err) {\r\n          const msg = (err as any)?.message;\r\n          results.push({\r\n            url: u,\r\n            ok: false,\r\n            error: msg ? String(msg) : String(err),\r\n          });\r\n        }\r\n      } catch (outer) {\r\n        const msg = (outer as any)?.message;\r\n        results.push({\r\n          url: u,\r\n          ok: false,\r\n          error: msg ? String(msg) : String(outer),\r\n        });\r\n      }\r\n    }\r\n    cfg.url = orig;\r\n    return { success: false, results };\r\n  }\r\n  function getLastError(): string | null {\r\n    if (_lastErr == null) return null;\r\n    if (typeof _lastErr === 'object' && 'message' in (_lastErr as any)) {\r\n      return String(((_lastErr as any).message));\r\n    }\r\n    return String(_lastErr);\r\n  }\r\n\r\n  // Small runtime helper: from the page console call __recorder.get('obs').pokeStatusTest()\r\n  // This triggers cfg.onStatus if present and logs a short dev entry.\r\n  function pokeStatusTest() {\r\n    try {\r\n      const meta = { now: Date.now(), note: 'poke' };\r\n      try {\r\n        window.logObs && window.logObs('poke', meta);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      cfg.onStatus && cfg.onStatus('poke', true, meta);\r\n      try {\r\n        if (window && window.__TP_DEV) console.info('[OBS adapter] pokeStatusTest fired', meta);\r\n      } catch {\r\n        // ignore\r\n      }\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Dev-only: expose a quick helper to test a specific candidate from the console\r\n  try {\r\n    if (typeof window !== 'undefined' && window.__TP_DEV) {\r\n      try {\r\n        window.__obsProbePorts = function (urls) {\r\n          try {\r\n            return probePorts(urls);\r\n          } catch (e) {\r\n            return Promise.reject(e);\r\n          }\r\n        };\r\n      } catch {\r\n        // ignore\r\n      }\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  return {\r\n    id: 'obs',\r\n    label: 'OBS (WebSocket)',\r\n    configure: configure,\r\n    isAvailable: isAvailable,\r\n    start: start,\r\n    stop: stop,\r\n    connect: connect,\r\n    test: test,\r\n    pokeStatusTest: pokeStatusTest,\r\n    // testCandidate removed; use __obsProbePorts or adapter.test()\r\n    getLastError: getLastError,\r\n  };\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": []
}

{
  "version": 3,
  "sources": ["obs.ts"],
  "sourcesContent": ["// OBS adapter for browser with dev-only candidate auth attempts and identify payload logging\r\n\r\n/** @returns {import('../recorders.js').RecorderAdapter} */\r\nexport function createOBSAdapter() {\r\n  var ws = null;\r\n  var identified = false;\r\n  var _lastErr = null;\r\n  var cfg = { url: 'ws://127.0.0.1:4455', password: '' };\r\n\r\n  // Dev tracing state\r\n  var _candidateList = null;\r\n  var _candidateIndex = 0;\r\n  var _lastAuthSent = null;\r\n  var _lastCandidateIndexUsed = null;\r\n  var _retryingCandidates = false;\r\n  // reconnect/backoff state\r\n  var _backoff = 800;\r\n  var _attempts = 0;\r\n\r\n  // lightweight dev log (keeps short history when window._TP_DEV is enabled)\r\n  try {\r\n    if (typeof window !== 'undefined') {\r\n      window.__obsLog = window.__obsLog || [];\r\n      window.__obsLogMax = window.__obsLogMax || 500;\r\n      window.logObs = function (ev, data) {\r\n        try {\r\n          if (!window._TP_DEV) return;\r\n          window.__obsLog.push({ t: Date.now(), ev: ev, data: data });\r\n          if (window.__obsLog.length > window.__obsLogMax) {\r\n            window.__obsLog.splice(0, window.__obsLog.length - window.__obsLogMax);\r\n          }\r\n        } catch {\r\n          void 0;\r\n        }\r\n      };\r\n    }\r\n  } catch {\r\n    void 0;\r\n  }\r\n\r\n  var _enc = function (s) {\r\n    return new TextEncoder().encode(s);\r\n  };\r\n  var _b64 = function (buf) {\r\n    return btoa(String.fromCharCode.apply(null, new Uint8Array(buf)));\r\n  };\r\n  // Keep last auth sent for debug logging\r\n  // canonical OBS v5 auth \u2014 exact recipe (no trims, no decoding, UTF-8 byte hashes)\r\n  const _te = new TextEncoder();\r\n  async function _sha(s) {\r\n    return crypto.subtle.digest('SHA-256', _te.encode(s));\r\n  }\r\n  async function computeObsAuth(password, authInfo) {\r\n    // authInfo is expected to contain { salt, challenge }\r\n    const salt = authInfo && authInfo.salt ? String(authInfo.salt) : '';\r\n    const challenge = authInfo && authInfo.challenge ? String(authInfo.challenge) : '';\r\n    // 1) secretB64 = base64( SHA256( password + salt ) )\r\n    const secretBuf = await _sha(String(password ?? '') + salt);\r\n    const secretB64 = _b64(secretBuf);\r\n    // 2) authentication = base64( SHA256( secretB64 + challenge ) )\r\n    const authBuf = await _sha(secretB64 + challenge);\r\n    return _b64(authBuf);\r\n  }\r\n\r\n  function configure(newCfg) {\r\n    cfg = Object.assign({}, cfg, newCfg || {});\r\n  }\r\n  function isAvailable() {\r\n    return Promise.resolve(typeof WebSocket !== 'undefined');\r\n  }\r\n\r\n  // computeAuthCandidates removed; using canonical computeObsAuth\r\n\r\n  function _connect(opts) {\r\n    opts = opts || {};\r\n    var testOnly = !!opts.testOnly;\r\n    return new Promise(function (resolve, reject) {\r\n      try {\r\n        try {\r\n          if (ws) ws.close(1000, 'reconnect');\r\n                } catch {\r\n                void 0;\r\n              }\r\n        identified = false;\r\n        _lastErr = null;\r\n        var url = cfg.url || 'ws://127.0.0.1:4455';\r\n        ws = new WebSocket(url);\r\n\r\n        ws.onopen = function () {\r\n          try {\r\n            if (window && window.__TP_DEV) console.debug('[OBS-HS] socket open', url);\r\n            } catch {\r\n                void 0;\r\n              }\r\n          try {\r\n            window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n            window.__obsHandshakeLog.push({ t: Date.now(), event: 'open', url: url });\r\n            try {\r\n              _backoff = 800;\r\n              _attempts = 0;\r\n            } catch {}\r\n            try {\r\n              cfg.onStatus && cfg.onStatus('connected', true);\r\n              try {\r\n                // dev log\r\n                window.logObs && window.logObs('open', { url: url });\r\n              } catch {\r\n                  void 0;\r\n                }\r\n            } catch {}\r\n            } catch {\r\n                void 0;\r\n              }\r\n        };\r\n\r\n        ws.onmessage = async function (ev) {\r\n          try {\r\n            var msg = JSON.parse(ev.data);\r\n            try {\r\n              if (window && window.__TP_DEV) console.debug('[OBS-HS] recv op=' + msg.op, msg.d);\r\n                    } catch {\r\n                    void 0;\r\n                    }\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              window.__obsHandshakeLog.push({ t: Date.now(), op: msg.op, data: msg.d });\r\n            } catch {\r\n              void ex;\r\n            }\r\n\r\n            if (msg.op === 0) {\r\n              var authInfo = msg.d && msg.d.authentication;\r\n              try {\r\n                window.logObs && window.logObs('hello', { authentication: authInfo });\r\n              } catch {\r\n                void ex;\r\n              }\r\n              var identify = { op: 1, d: { rpcVersion: 1 } };\r\n              if (authInfo) {\r\n                // Read password without trimming or normalization. Prefer configured value, then cfg.getPass(), then DOM fallbacks.\r\n                var pass = '';\r\n                try {\r\n                  if (typeof cfg.password !== 'undefined' && cfg.password !== null)\r\n                    pass = String(cfg.password);\r\n                  else if (typeof cfg.getPass === 'function') pass = String(cfg.getPass());\r\n                } catch {\r\n                  try {\r\n                    pass = String(cfg.password || '');\r\n                  } catch {\r\n                    pass = '';\r\n                  }\r\n                }\r\n                if (!pass) {\r\n                  try {\r\n                    var domPass = '';\r\n                    var setEl =\r\n                      typeof document !== 'undefined' && document.getElementById('settingsObsPass');\r\n                    var mainEl =\r\n                      typeof document !== 'undefined' && document.getElementById('obsPassword');\r\n                    // Do NOT trim \u2014 spaces are valid characters\r\n                    if (setEl && setEl.value) domPass = setEl.value;\r\n                    else if (mainEl && mainEl.value) domPass = mainEl.value;\r\n                    if (domPass) pass = domPass;\r\n                    if (domPass && window && window.__TP_DEV)\r\n                      console.debug('[OBS adapter] using DOM password fallback (settings/main)');\r\n                  } catch {\r\n                    /* ignore */\r\n                  }\r\n                }\r\n                if (!pass) {\r\n                  try {\r\n                    ws.close(4009, 'password-empty');\r\n                  } catch {\r\n                    void ex;\r\n                  }\r\n                  _lastErr = new Error('OBS authentication required but no password is set.');\r\n                  return reject(_lastErr);\r\n                }\r\n\r\n                // Compute canonical OBS v5 authentication value and attach to identify payload\r\n                try {\r\n                  const authVal = await computeObsAuth(pass, authInfo);\r\n                  identify.d.authentication = authVal;\r\n                  _lastAuthSent = authVal;\r\n                  if (window && window.__TP_DEV)\r\n                    console.debug('[OBS-HS] sending IDENTIFY (authentication present)');\r\n                  try {\r\n                    if (window && window.__TP_DEV)\r\n                      console.debug('[OBS-HS] IDENTIFY payload:', identify);\r\n                  } catch {\r\n                    void ex;\r\n                  }\r\n                  try {\r\n                    window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n                    var ent = {\r\n                      t: Date.now(),\r\n                      event: 'identify-sent',\r\n                      auth: !!identify.d.authentication,\r\n                    };\r\n                    if (window && window.__TP_DEV) ent.identifyPayload = identify;\r\n                    window.__obsHandshakeLog.push(ent);\r\n                    window.logObs &&\r\n                      window.logObs('identify-sent', { auth: !!identify.d.authentication });\r\n                  } catch {\r\n                    void ex;\r\n                  }\r\n                } catch {\r\n                  // failed to compute auth \u2014 set last error and close\r\n                  _lastErr = exAuth;\r\n                  try {\r\n                    ws.close(4009, 'auth-compute-failed');\r\n                  } catch {\r\n                    void ex;\r\n                  }\r\n                  return reject(exAuth);\r\n                }\r\n              }\r\n              try {\r\n                ws.send(JSON.stringify(identify));\r\n              } catch {\r\n                void ex;\r\n              }\r\n            } else if (msg.op === 2) {\r\n              identified = true;\r\n              try {\r\n                if (window && window.__TP_DEV) console.debug('[OBS-HS] IDENTIFIED', msg.d);\r\n              } catch {\r\n                void ex;\r\n              }\r\n              try {\r\n                window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n                window.__obsHandshakeLog.push({ t: Date.now(), event: 'identified', data: msg.d });\r\n                try {\r\n                  window.logObs && window.logObs('identified', { data: msg.d });\r\n                } catch {\r\n                  void ex;\r\n                }\r\n              } catch {\r\n                void ex;\r\n              }\r\n              if (testOnly) {\r\n                try {\r\n                  ws.close(1000, 'test-ok');\r\n                } catch {\r\n                  void ex;\r\n                }\r\n              }\r\n              return resolve(true);\r\n            }\r\n          } catch {\r\n            _lastErr = e;\r\n            try {\r\n              ws.close(4000, 'msg-parse-error');\r\n            } catch {\r\n              void ex;\r\n            }\r\n            return reject(e);\r\n          }\r\n        };\r\n\r\n        ws.onerror = function (ev) {\r\n          try {\r\n            if (window && window.__TP_DEV) console.debug('[OBS-HS] socket error', ev);\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              window.__obsHandshakeLog.push({ t: Date.now(), event: 'error', data: ev });\r\n              try {\r\n                window.logObs && window.logObs('error', { data: ev });\r\n              } catch {\r\n                void ex;\r\n              }\r\n            } catch {\r\n              void ex;\r\n            }\r\n          } catch {\r\n            void ex;\r\n          }\r\n        };\r\n\r\n        ws.onclose = function (e) {\r\n          try {\r\n            if (window && window.__TP_DEV)\r\n              console.debug('[OBS-HS] socket close', e && e.code, e && e.reason);\r\n            try {\r\n              window.__obsHandshakeLog = window.__obsHandshakeLog || [];\r\n              var entry = {\r\n                t: Date.now(),\r\n                event: 'close',\r\n                code: (e && e.code) || 0,\r\n                reason: (e && e.reason) || '',\r\n              };\r\n              if (e && e.code === 4009 && window && window.__TP_DEV) {\r\n                try {\r\n                  entry.debugAuth = _lastAuthSent || null;\r\n                } catch {\r\n                  void ex;\r\n                }\r\n              }\r\n              window.__obsHandshakeLog.push(entry);\r\n              try {\r\n                window.logObs &&\r\n                  window.logObs('close', {\r\n                    code: (e && e.code) || 0,\r\n                    reason: (e && e.reason) || '',\r\n                  });\r\n              } catch {\r\n                void ex;\r\n              }\r\n              try {\r\n                // increment attempts and advance backoff for retry reporting\r\n                _attempts = (_attempts || 0) + 1;\r\n                _backoff = Math.min(Math.floor((_backoff || 800) * 1.6), 8000);\r\n                cfg.onStatus &&\r\n                  cfg.onStatus('closed', false, {\r\n                    code: (e && e.code) || 0,\r\n                    reason: (e && e.reason) || '',\r\n                    attempt: _attempts,\r\n                    backoffMs: _backoff,\r\n                  });\r\n              } catch {\r\n                void ex;\r\n              }\r\n            } catch {\r\n              void ex;\r\n            }\r\n          } catch {\r\n            void ex;\r\n          }\r\n\r\n          if (!identified) {\r\n            var err = new Error(\r\n              ('close ' + ((e && e.code) || 0) + ' ' + ((e && e.reason) || '')).trim()\r\n            );\r\n            _lastErr = err;\r\n            try {\r\n              if (\r\n                cfg &&\r\n                typeof cfg.isEnabled === 'function' &&\r\n                cfg.isEnabled() &&\r\n                (e && e.code) !== 1000\r\n              ) {\r\n                try {\r\n                  setTimeout(function () {\r\n                    try {\r\n                      connect();\r\n                    } catch {}\r\n                  }, _backoff);\r\n                } catch {}\r\n              }\r\n            } catch {}\r\n            return reject(err);\r\n          }\r\n        };\r\n      } catch {\r\n        _lastErr = outer;\r\n        return reject(outer);\r\n      }\r\n    });\r\n  }\r\n\r\n  // wrapper to call _connect in non-test mode; returns a promise\r\n  function connect() {\r\n    return _connect({ testOnly: false });\r\n  }\r\n\r\n  async function start() {\r\n    await connect();\r\n  }\r\n  async function stop() {\r\n    identified = false;\r\n    try {\r\n      if (ws) ws.close(1000, 'stop');\r\n    } catch {\r\n      void ex;\r\n    }\r\n    ws = null;\r\n  }\r\n  async function test() {\r\n    return _connect({ testOnly: true });\r\n  }\r\n  // Dev helper: probe multiple ws URLs (host+port) and return which one authenticates.\r\n  // Accepts an array of url strings (e.g. ['ws://host:4455','ws://host:64376']).\r\n  async function probePorts(urls) {\r\n    if (!Array.isArray(urls)) throw new Error('urls must be an array');\r\n    const orig = cfg.url;\r\n    const results = [];\r\n    for (let u of urls) {\r\n      try {\r\n        cfg.url = u;\r\n        try {\r\n          const ok = await _connect({ testOnly: true });\r\n          results.push({ url: u, ok: !!ok });\r\n          if (ok) {\r\n            // restore and return early with success\r\n            cfg.url = orig;\r\n            return { success: true, url: u, results };\r\n          }\r\n        } catch {\r\n          results.push({\r\n            url: u,\r\n            ok: false,\r\n            error: String(err && err.message ? err.message : err),\r\n          });\r\n        }\r\n      } catch {\r\n        results.push({\r\n          url: u,\r\n          ok: false,\r\n          error: String(outer && outer.message ? outer.message : outer),\r\n        });\r\n      }\r\n    }\r\n    cfg.url = orig;\r\n    return { success: false, results };\r\n  }\r\n  function getLastError() {\r\n    return _lastErr ? _lastErr.message || String(_lastErr) : null;\r\n  }\r\n\r\n  // Small runtime helper: from the page console call __recorder.get('obs').pokeStatusTest()\r\n  // This triggers cfg.onStatus if present and logs a short dev entry.\r\n  function pokeStatusTest() {\r\n    try {\r\n      const meta = { now: Date.now(), note: 'poke' };\r\n      try {\r\n        window.logObs && window.logObs('poke', meta);\r\n      } catch {\r\n        void ex;\r\n      }\r\n      cfg.onStatus && cfg.onStatus('poke', true, meta);\r\n      try {\r\n        if (window && window.__TP_DEV) console.info('[OBS adapter] pokeStatusTest fired', meta);\r\n      } catch {\r\n        void ex;\r\n      }\r\n      return true;\r\n    } catch {\r\n      void ex;\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Dev-only: expose a quick helper to test a specific candidate from the console\r\n  try {\r\n    if (typeof window !== 'undefined' && window.__TP_DEV) {\r\n      try {\r\n        window.__obsProbePorts = function (urls) {\r\n          try {\r\n            return probePorts(urls);\r\n          } catch {\r\n            return Promise.reject(ex);\r\n          }\r\n        };\r\n      } catch {\r\n        void ex;\r\n      }\r\n    }\r\n  } catch {\r\n    void ex;\r\n  }\r\n\r\n  return {\r\n    id: 'obs',\r\n    label: 'OBS (WebSocket)',\r\n    configure: configure,\r\n    isAvailable: isAvailable,\r\n    start: start,\r\n    stop: stop,\r\n    connect: connect,\r\n    test: test,\r\n    pokeStatusTest: pokeStatusTest,\r\n    // testCandidate removed; use __obsProbePorts or adapter.test()\r\n    getLastError: getLastError,\r\n  };\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": ["e", "err"]
}
